# Функционал водителей для автомобилей

## Описание

Добавлен новый функционал для управления водителями автомобилей в основной сервис автомобилей. Теперь владельцы автомобилей могут добавлять дополнительных водителей и управлять их доступом.

## Возможности

### Для владельцев автомобилей:
- Просмотр списка всех водителей
- Добавление новых водителей через Telegram контакты
- Удаление водителей
- Просмотр информации о каждом водителе

### Для водителей:
- Просмотр информации об автомобиле
- Доступ к основным функциям автомобиля

## Структура базы данных

### Таблица `car_drivers`
- `id` - уникальный идентификатор записи
- `carId` - ID автомобиля (внешний ключ)
- `driverId` - ID пользователя-водителя (внешний ключ)
- `isOwner` - флаг владельца (по умолчанию false)
- `createdAt` - дата добавления
- `updatedAt` - дата обновления

## API Endpoints

### Получение списка водителей
```
GET /car/:carId/drivers
Authorization: Bearer <token>
```

### Добавление водителя
```
POST /car/:carId/add-driver
Authorization: Bearer <token>
Body: {
  "contact": {
    "id": number,
    "first_name": string,
    "last_name": string,
    "username": string,
    "phone_number": string
  },
  "carId": number
}
```

### Удаление водителя
```
DELETE /car/:carId/remove-driver
Authorization: Bearer <token>
Body: {
  "driverId": number,
  "carId": number
}
```

## Архитектура

Функционал водителей интегрирован в основной `CarService` и `CarController`, что обеспечивает:
- Единую точку управления автомобилями и водителями
- Простоту поддержки и развития
- Консистентность API

## Компоненты React

### CarDrivers
Отображает список всех водителей автомобиля с возможностью удаления (для владельцев).

### AddDriverButton
Кнопка для добавления нового водителя через Telegram контакт.

## Безопасность

- Только владельцы автомобилей могут добавлять/удалять водителей
- Водители могут просматривать информацию об автомобиле
- Все операции требуют аутентификации через JWT токен

## Использование

### В компоненте CarFullInfo:
```tsx
{isOwner && (
  <>
    <CarDrivers carId={info.id} isOwner={isOwner} />
    <CenterContainer>
      <AddDriverButton carId={info.id} eventData={{ code: info.code }} />
    </CenterContainer>
  </>
)}
```

## Миграции

Для применения изменений в базе данных выполните:
```bash
npm run migration:run
```

## Тестирование

Функционал протестирован на:
- Добавление водителей
- Удаление водителей
- Проверка прав доступа
- Валидация данных

## Зависимости

- TypeORM для работы с базой данных
- NestJS для backend API
- React для frontend компонентов
- Telegram Web App SDK для получения контактов 